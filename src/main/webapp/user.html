<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>User</title>
    <link href="css/user.css" rel="stylesheet" type="text/css">
    <link href="css/common.css" rel="stylesheet" type="text/css">
    <script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <!--导入angularJS文件-->
    <script src="js/angular.min.js"></script>
    <!--导入jquery-->
    <script src="js/jquery-3.3.1.js"></script>
    <script src="js/user.js" type="application/javascript"></script>
    <script type="text/javascript">

        $(function (){
            var uid;
            $.post("user/findOne",{},function (data){
                uid = data.uid;
                displayMission();
                displaySchedule();
            });
            function displayMission(){
                $.post("mission/findMissionByUid",{uid:uid},function (data){
                    var lis = "";
                    for (var value of data) {
                        var li = "<li><input type=\"checkbox\" class=\"mis_box\" disabled value= "+value.mid+" >"+value.mission+"</li>"
                        lis += li;
                    }
                    $("#missions").html(lis);
                });
            }
            function displaySchedule(){
                $.post("schedule/findScheduleByUid",{uid:uid},function (data){
                    var lis = "";
                    for (var value of data) {
                        var li = "<li><input type=\"checkbox\" class=\"schedule_box\" disabled value= "+value.sid+" >"+value.t_start+'~'+value.t_end+'&nbsp;'+value.dailyMission+"</li>"
                        lis += li;
                    }
                    $("#schedule").html(lis);
                });
            }
            $("#settingMission").click(function (){
                if($("#txt_Mission").val() != 0){
                    $.post("mission/setMission",{uid:uid,mission:$("#txt_Mission").val().toString()},function (data){
                       if (data){
                           $("#txt_Mission").val("");
                           displayMission();
                       } else{
                           alert("慢慢来");
                       }
                    });
                }else{
                    alert("请输入要设置的任务")
                }
            });

            $("#deleteMission").click(function (){
                $("input[class='mis_box']:checked")
                    .each(function(){
                    $.post("mission/deleteMissionByMid",{value:this.value},function (data){
                        if(data){
                            displayMission();
                        }
                    });
                });
            })

            $("#settingSchedule").click(function (){
                if($("#txt_Schedule").val() != 0 && $("#start").val() != 0 && $("#end").val() != 0) {
                    $.post("schedule/setSchedule", {
                        uid: uid,
                        start: $("#start").val(),
                        end: $("#end").val(),
                        dailyMission: $("#txt_Schedule").val()
                    }, function (data) {
                        if(data){
                            $("#start").val("");
                            $("#end").val("");
                            $("#txt_Schedule").val("");
                            displaySchedule();
                        }else{
                            alert("更新数据库失败");
                        }
                    });
                }else{
                    alert("请输入完整信息")
                }
            });

            $("#deleteSchedule").click(function (){
                $("input[class='schedule_box']:checked")
                    .each(function(){
                        $.post("schedule/deleteScheduleBySid",{value:this.value},function (data){
                            if(data){
                                displaySchedule();
                            }
                        });
                    });
            })
        })


    </script>
</head>
<body>
    <!--引入头部-->
    <div id="header"></div>

    <div class="container">
		
        <div class="left">
<!--			<div id="mission">-->
				<div class="title">missions</div>
            <form id="mission_form">
                <ul id="missions" >
                    <!-- <li><input type="checkbox" class="mis_box" disabled >success means different things for different people</li>-->
                </ul>
                <div id="setMission">
                    <input type="text" id="txt_Mission" class="txt" placeholder="请输入要设置的任务">
                    <input type="button" class="btn" id="settingMission" value="设置">
                    <input type="button" class="btn" id="selectMission" value="选择">
                    <input type="button" class="btn" id="selectAllMission" value="全选">
                    <input type="button" class="btn" id="deleteMission" value="删除选中">
                </div>
            </form>
<!--			</div>-->
        </div>

        <div class="right">
            <div class="title">schedule</div>
				<ul id="schedule">
					<li><input type="checkbox" class="schedule_box" disabled>12:00~13:00 读书读书读书</li>

                </ul>
            <div id="setSchedule">
                <div >
                    <input type="text" class="txt" id="start" placeholder="00:00">~
                    <input type="text" class="txt" id="end" placeholder="24:00">
                    <input type="text" class="txt" id="txt_Schedule" placeholder="请输入时间段分配任务">
                </div>
                <div>
                    <input type="button" class="btn" id="settingSchedule" value="设置">
                    <input type="button" class="btn" id="selectSchedule" value="选择">
                    <input type="button" class="btn" id="selectAllSchedule" value="全选">
                    <input type="button" class="btn" id="deleteSchedule"   value="删除选中">
                </div>
            </div>
        </div>
        <div class="center">
<!--            <div id="apps">-->
             <div class="title">apps</div>
                <div>
                    <input type="button" class="button" onclick="javascript:window.location.href='countDown.html'"; value="countDown">
                    <input type="button" class="button" onclick="javascript:window.location.href='goldfish.html'"; value="goldfish">
                </div>
<!--            </div>-->
        </div>
		
    </div>


    <!--引入尾部-->
    <div id="footer"></div>
    <!--导入布局js，共享header和footer-->
    <script type="text/javascript" src="js/include.js"></script>
</body>
</html>